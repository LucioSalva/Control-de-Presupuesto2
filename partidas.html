<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Partidas Detalladas — Control Presupuestal</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- SweetAlert2 -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <!-- Navbar Principal Delgada -->
    <nav class="navbar navbar-expand-lg navbar-dark shadow-sm" style="min-height: 50px;">
        <div class="container-fluid">
            <a class="navbar-brand fw-semibold">
                <i class="bi bi-currency-dollar me-2"></i>Control Presupuestal
            </a>

            <div class="logo-container">
                <img src="/public/img/ayuntamiento-de-ecatepec.png" alt="Ayuntamiento de Ecatepec" class="navbar-logo"
                    style="height: 40px;">
            </div>

            <div class="ms-auto d-flex gap-2 align-items-center">
                <button id="btn-export-partidas" class="btn btn-outline-success btn-sm">
                    <i class="bi bi-file-earmark-excel me-1"></i>Exportar Excel
                </button>
                <button id="btn-guardar-partidas" class="btn btn-outline-primary btn-sm">
                    <i class="bi bi-save me-1"></i>Guardar
                </button>
            </div>
        </div>
    </nav>

    <!-- Navbar de Pestañas -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm" style="min-height: 40px;">
        <div class="container-fluid">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0" style="flex-direction: row;">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">
                        <i class="bi bi-house me-1"></i>Presupuesto
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="partidas.html">
                        <i class="bi bi-list-check me-1"></i>Partidas Detalladas
                    </a>
                </li>
            </ul>
            <div class="d-flex align-items-center">
                <span class="navbar-text me-3">
                    <i class="bi bi-calendar me-1"></i>
                    <span id="fecha-actual"></span>
                </span>
                <div class="input-group input-group-sm" style="width: 200px;">
                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                    <input type="text" id="buscar-partidas" class="form-control" placeholder="Buscar partidas...">
                </div>
            </div>
        </div>
    </nav>

    <main class="container py-4">
        <div class="row">
            <div class="col-12">
                <div class="card mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-4">
                            <i class="bi bi-list-check me-2"></i>Partidas Detalladas
                        </h5>

                        <!-- Información del proyecto -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="input-group mb-3">
                                    <span class="input-group-text">Proyecto ID</span>
                                    <input type="text" class="form-control" id="proyecto-id"
                                        placeholder="Ingrese ID del proyecto">
                                    <button class="btn btn-outline-secondary" type="button" id="btn-cargar-partidas">
                                        <i class="bi bi-download"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="input-group mb-3">
                                    <span class="input-group-text">Fecha</span>
                                    <input type="date" class="form-control" id="fecha-partida" value="">
                                </div>
                            </div>
                        </div>

                        <!-- Formulario para agregar partidas -->
                        <form id="form-partida-detalle" class="row g-3 mb-4">
                            <div class="col-md-2">
                                <label class="form-label">Cantidad</label>
                                <input type="number" class="form-control" id="cantidad" step="0.01" min="0" required>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Unidad de Medida</label>
                                <input type="text" class="form-control" id="unidad-medida" required>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Descripción del Artículo/Bien y/o Servicio</label>
                                <input type="text" class="form-control" id="descripcion" required>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Precio Unitario</label>
                                <input type="number" class="form-control" id="precio-unitario" step="0.01" min="0"
                                    required>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Importe Total</label>
                                <input type="text" class="form-control" id="importe-total" readonly>
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-success">
                                    <i class="bi bi-plus-circle me-1"></i>Agregar Partida
                                </button>
                                <button type="button" id="btn-limpiar-partidas" class="btn btn-outline-secondary">
                                    <i class="bi bi-eraser me-1"></i>Limpiar Todo
                                </button>
                            </div>
                        </form>

                        <!-- Tabla de partidas -->
                        <div class="table-responsive">
                            <table class="table table-striped" id="tabla-partidas">
                                <thead class="table-dark">
                                    <tr>
                                        <th>#</th>
                                        <th>Cantidad</th>
                                        <th>Unidad de Medida</th>
                                        <th>Descripción</th>
                                        <th class="text-end">Precio Unitario</th>
                                        <th class="text-end">Importe Total</th>
                                        <th class="text-center">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="tbody-partidas">
                                    <!-- Las partidas se agregarán aquí dinámicamente -->
                                </tbody>
                                <tfoot class="table-secondary">
                                    <tr>
                                        <td colspan="5" class="text-end fw-bold">Subtotal:</td>
                                        <td class="text-end fw-bold" id="subtotal">$0.00</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="text-end fw-bold">IVA (16%):</td>
                                        <td class="text-end fw-bold" id="iva">$0.00</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td colspan="5" class="text-end fw-bold">Total:</td>
                                        <td class="text-end fw-bold fs-5 text-primary" id="total-general">$0.00</td>
                                        <td></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>

                        <!-- Total en letras -->
                        <div class="card mt-4">
                            <div class="card-body">
                                <h6 class="card-subtitle mb-2 text-muted">Total en Letras:</h6>
                                <p class="card-text fs-5 fw-bold" id="total-letras">CERO PESOS 00/100 MXN</p>
                            </div>
                        </div>

                        <!-- Información de fechas -->
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <small class="text-muted">
                                    <i class="bi bi-calendar-plus me-1"></i>
                                    Creado: <span id="fecha-creacion">--/--/----</span>
                                </small>
                            </div>
                            <div class="col-md-6 text-end">
                                <small class="text-muted">
                                    <i class="bi bi-calendar-check me-1"></i>
                                    Actualizado: <span id="fecha-actualizacion">--/--/----</span>
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Bootstrap bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- XLSX para exportación -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- Script de partidas -->
    <script src="js/partidas.js"></script>
</body>

</html>